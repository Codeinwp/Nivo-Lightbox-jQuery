/*
* Nivo Lightbox v1.2.0
* http://dev7studios.com/nivo-lightbox
*
* Copyright 2013, Dev7studios
* Free to use and abuse under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
*/
(function(a,l,p,q){function m(c,b){this.el=c;this.$el=a(this.el);this.options=a.extend({},n,b);this._defaults=n;this._name="nivoLightbox";this.init()}var n={effect:"fade",theme:"default",keyboardNav:!0,clickOverlayToClose:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(a){},beforeHideLightbox:function(){},afterHideLightbox:function(){},onPrev:function(a){},onNext:function(a){},errorMessage:"The requested content cannot be loaded. Please try again later."};m.prototype=
{init:function(){var c=this;a("html").hasClass("nivo-lightbox-notouch")||a("html").addClass("nivo-lightbox-notouch");"ontouchstart"in p&&a("html").removeClass("nivo-lightbox-notouch");this.$el.on("click",function(a){c.showLightbox(a)});if(this.options.keyboardNav)a("body").off("keyup").on("keyup",function(b){b=b.keyCode?b.keyCode:b.which;27==b&&c.destructLightbox();37==b&&a(".nivo-lightbox-prev").trigger("click");39==b&&a(".nivo-lightbox-next").trigger("click")});this.options.onInit.call(this)},showLightbox:function(c){var b=
this,e=this.$el;if(this.checkContent(e)){c.preventDefault();this.options.beforeShowLightbox.call(this);var f=this.constructLightbox();if(f){var d=f.find(".nivo-lightbox-content");if(d){a("body").addClass("nivo-lightbox-body-effect-"+this.options.effect);this.processContent(d,e);if(this.$el.attr("data-lightbox-gallery")){var g=a('[data-lightbox-gallery="'+this.$el.attr("data-lightbox-gallery")+'"]');a(".nivo-lightbox-nav").show();a(".nivo-lightbox-prev").off("click").on("click",function(c){c.preventDefault();
c=g.index(e);e=g.eq(c-1);a(e).length||(e=g.last());b.processContent(d,e);b.options.onPrev.call(this,[e])});a(".nivo-lightbox-next").off("click").on("click",function(c){c.preventDefault();c=g.index(e);e=g.eq(c+1);a(e).length||(e=g.first());b.processContent(d,e);b.options.onNext.call(this,[e])})}setTimeout(function(){f.addClass("nivo-lightbox-open");b.options.afterShowLightbox.call(this,[f])},1)}}}},checkContent:function(a){var b=a.attr("href"),e=b.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))\/([\w]+)?([\S]+)/);
return null!==b.match(/\.(jpeg|jpg|gif|png)$/i)||e||"ajax"==a.attr("data-lightbox-type")||"#"==b.substring(0,1)&&"inline"==a.attr("data-lightbox-type")||"iframe"==a.attr("data-lightbox-type")?!0:!1},processContent:function(c,b){var e=this,f=b.attr("href"),d=f.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))\/([\w]+)?([\S]+)/);c.html("").addClass("nivo-lightbox-loading");this.isHidpi()&&b.attr("data-lightbox-hidpi")&&(f=b.attr("data-lightbox-hidpi"));if(null!==f.match(/\.(jpeg|jpg|gif|png)$/i)){var g=
a("<img>",{src:f});g.one("load",function(){var b=a('<div class="nivo-lightbox-image" />');b.append(g);c.html(b).removeClass("nivo-lightbox-loading");b.css({"line-height":a(".nivo-lightbox-content").height()+"px",height:a(".nivo-lightbox-content").height()+"px"});a(l).resize(function(){b.css({"line-height":a(".nivo-lightbox-content").height()+"px",height:a(".nivo-lightbox-content").height()+"px"})})}).each(function(){this.complete&&a(this).load()});g.error(function(){var b=a('<div class="nivo-lightbox-error"><p>'+
e.options.errorMessage+"</p></div>");c.html(b).removeClass("nivo-lightbox-loading")})}else if(d){var f="",h="nivo-lightbox-video";"youtube"==d[1]&&(f="http://www.youtube.com/embed/"+d[6]+d[7],h="nivo-lightbox-youtube");"youtu"==d[1]&&(f="http://www.youtube.com/embed/"+d[6]+d[7],h="nivo-lightbox-youtube");"vimeo"==d[1]&&(f="http://player.vimeo.com/video/"+d[3],h="nivo-lightbox-vimeo");f&&(d=a("<iframe>",{src:f,"class":h,frameborder:0,vspace:0,hspace:0,scrolling:"auto"}),c.html(d),d.load(function(){c.removeClass("nivo-lightbox-loading")}))}else if("ajax"==
b.attr("data-lightbox-type"))a.ajax({url:f,cache:!1,success:function(b){var d=a('<div class="nivo-lightbox-ajax" />');d.append(b);c.html(d).removeClass("nivo-lightbox-loading");d.outerHeight()<c.height()&&d.css({position:"relative",top:"50%","margin-top":-(d.outerHeight()/2)+"px"});a(l).resize(function(){d.outerHeight()<c.height()&&d.css({position:"relative",top:"50%","margin-top":-(d.outerHeight()/2)+"px"})})},error:function(){var b=a('<div class="nivo-lightbox-error"><p>'+e.options.errorMessage+
"</p></div>");c.html(b).removeClass("nivo-lightbox-loading")}});else if("#"==f.substring(0,1)&&"inline"==b.attr("data-lightbox-type"))if(a(f).length){var k=a('<div class="nivo-lightbox-inline" />');k.append(a(f).clone().show());c.html(k).removeClass("nivo-lightbox-loading");k.outerHeight()<c.height()&&k.css({position:"relative",top:"50%","margin-top":-(k.outerHeight()/2)+"px"});a(l).resize(function(){k.outerHeight()<c.height()&&k.css({position:"relative",top:"50%","margin-top":-(k.outerHeight()/2)+
"px"})})}else d=a('<div class="nivo-lightbox-error"><p>'+e.options.errorMessage+"</p></div>"),c.html(d).removeClass("nivo-lightbox-loading");else if("iframe"==b.attr("data-lightbox-type"))d=a("<iframe>",{src:f,"class":"nivo-lightbox-item",frameborder:0,vspace:0,hspace:0,scrolling:"auto"}),c.html(d),d.load(function(){c.removeClass("nivo-lightbox-loading")});else return!1;b.attr("title")?(d=a("<span>",{"class":"nivo-lightbox-title"}),d.text(b.attr("title")),a(".nivo-lightbox-title-wrap").html(d)):a(".nivo-lightbox-title-wrap").html("")},
constructLightbox:function(){if(a(".nivo-lightbox-overlay").length)return a(".nivo-lightbox-overlay");var c=a("<div>",{"class":"nivo-lightbox-overlay nivo-lightbox-theme-"+this.options.theme+" nivo-lightbox-effect-"+this.options.effect}),b=a("<div>",{"class":"nivo-lightbox-wrap"}),e=a("<div>",{"class":"nivo-lightbox-content"}),f=a('<a href="#" class="nivo-lightbox-nav nivo-lightbox-prev">Previous</a><a href="#" class="nivo-lightbox-nav nivo-lightbox-next">Next</a>'),d=a('<a href="#" class="nivo-lightbox-close" title="Close">Close</a>'),
g=a("<div>",{"class":"nivo-lightbox-title-wrap"});b.append(e);b.append(g);c.append(b);c.append(f);c.append(d);a("body").append(c);var h=this;if(h.options.clickOverlayToClose)c.on("click",function(b){(b.target===this||a(b.target).hasClass("nivo-lightbox-content")||a(b.target).hasClass("nivo-lightbox-image"))&&h.destructLightbox()});d.on("click",function(a){a.preventDefault();h.destructLightbox()});return c},destructLightbox:function(){this.options.beforeHideLightbox.call(this);a(".nivo-lightbox-overlay").removeClass("nivo-lightbox-open");
a(".nivo-lightbox-nav").hide();a("body").removeClass("nivo-lightbox-body-effect-"+this.options.effect);a(".nivo-lightbox-prev").off("click");a(".nivo-lightbox-next").off("click");a(".nivo-lightbox-content").empty();this.options.afterHideLightbox.call(this)},isHidpi:function(){return 1<l.devicePixelRatio||l.matchMedia&&l.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),                              (min--moz-device-pixel-ratio: 1.5),                              (-o-min-device-pixel-ratio: 3/2),                              (min-resolution: 1.5dppx)").matches?
!0:!1}};a.fn.nivoLightbox=function(c){return this.each(function(){a.data(this,"nivoLightbox")||a.data(this,"nivoLightbox",new m(this,c))})}})(jQuery,window,document);